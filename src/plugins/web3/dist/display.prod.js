"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _web=_interopRequireDefault(require("web3"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var web3=new _web.default(window.ethereum),dancerAbi=require("./abi/dancer_abi.json"),coachAbi=require("./abi/coach_abi.json"),crewAbi=require("./abi/crew_abi.json"),rewardpoolAbi=require("./abi/rewardpool_abi.json"),freehandleAbi=require("./abi/freehandler_abi.json"),tokenMDC=require("./abi/token_mdc.json"),tokenAddress=process.env.VUE_APP_TOKEN_ADDRESS,dancerAddress=process.env.VUE_APP_DANCER_ADDRESS,coachAddress=process.env.VUE_APP_COACH_ADDRESS,crewAddress=process.env.VUE_APP_CREW_ADDRESS,rewardpoolAddress=process.env.VUE_APP_REWARD_POOL_ADDRESS,freehandleAddress=process.env.VUE_APP_FEE_HANDLER,dancerContract=new web3.eth.Contract(dancerAbi,dancerAddress),coachContract=new web3.eth.Contract(coachAbi,coachAddress),crewContract=new web3.eth.Contract(crewAbi,crewAddress),rewardpoolContract=new web3.eth.Contract(rewardpoolAbi,rewardpoolAddress),feehandleContract=new web3.eth.Contract(freehandleAbi,freehandleAddress),tokenContract=new web3.eth.Contract(tokenMDC,tokenAddress),Display=function(){return{displayDancer:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(dancerContract.methods.getAllDancers(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},displayCoach:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(coachContract.methods.getAllCoachs(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},displayCrew:function(r){var t,n,a,c,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.getTokenIds(r).call());case 2:t=e.sent,n=[],a=[],c=0;case 6:if(c<t.length)return e.next=9,regeneratorRuntime.awrap(crewContract.methods.getCrew(t[c]).call());e.next=28;break;case 9:return a=e.sent,(s={name:"",tokenID:0,supply:0,dp:0,member:null,checkCrew:"dancer",check:!1,dancersId:null,coachesId:null,dancers:[],coaches:[],lastBattleTime:[],canBattle:0,dancersCount:0,coachesCount:0}).tokenID=t[c],s.name=a[0],s.coachesId=a[1],s.dancersId=a[2],s.supply=a[3],s.dp=a[4],s.lastBattleTime=a[5],s.coachesCount=a[1].length,s.dancersCount=a[2].length,e.next=22,regeneratorRuntime.awrap(this.canBattleDance(t[c]));case 22:s.canBattle=e.sent,s.member="D/"+a[2].length+",C/"+a[1].length,n.push(s);case 25:c++,e.next=6;break;case 28:return e.abrupt("return",n);case 29:case"end":return e.stop()}},null,this)},getCrew:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.getCrew(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},getDancers:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(dancerContract.methods.getDancer(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},getCoaches:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(coachContract.methods.getCoach(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},balanceOfDancer:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(dancerContract.methods.balanceOf(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},balanceOfCoach:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(coachContract.methods.balanceOf(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},balanceOfCrew:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.balanceOf(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},canBattleDance:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.canBattleDance(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},getAvailableCrewsCount:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.getAvailableCrewsCount(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},viewBonusReferrer:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.viewBonusReferrer(r).call());case 2:if(0<(t=e.sent))return e.abrupt("return",parseFloat(t).toFixed(2));e.next=7;break;case 7:return e.abrupt("return",0);case 8:case"end":return e.stop()}})},claimRefferalBonus:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.claimRefferalBonus().send({from:r}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0;case 1:case"end":return e.stop()}})}).catch(function(){t=!1}));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}})},RewardAfterTax:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.RewardAfterTax().call({from:r}));case 2:return t=e.sent,e.abrupt("return",parseFloat(web3.utils.fromWei(t,"ether")).toFixed(2));case 4:case"end":return e.stop()}})},getMaxBattlePower:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.getMaxBattlePower(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},getTaxLeftDays:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.getTaxLeftDays(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},getMDCAmountFromUSD:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(feehandleContract.methods.getMDCAmountFromUSD(r).call());case 2:return t=e.sent,e.abrupt("return",parseFloat(web3.utils.fromWei(t,"ether")).toFixed(3));case 4:case"end":return e.stop()}})},getUSDAmountFromMDC:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(feehandleContract.methods.getUSDAmountInMDC(r).call());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}})},buyDrink:function(t,n,a,c){var s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(tokenContract.methods.allowance(t,crewAddress).call().then(function(r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(parseInt(r)<web3.utils.toWei("1000","ether"))return e.next=3,regeneratorRuntime.awrap(tokenContract.methods.approve(crewAddress,web3.utils.toWei("10000","ether")).send({from:t}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.addSupply(n,a,c).send({from:t}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:s=!0;case 1:case"end":return e.stop()}})}).catch(function(){s=!1}));case 2:case"end":return e.stop()}})}));e.next=5;break;case 3:e.next=8;break;case 5:if(parseInt(r)>=web3.utils.toWei("1000","ether"))return e.next=8,regeneratorRuntime.awrap(crewContract.methods.addSupply(n,a,c).send({from:t}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:s=!0;case 1:case"end":return e.stop()}})}).catch(function(){s=!1}));e.next=8;break;case 8:case"end":return e.stop()}})}));case 2:return e.abrupt("return",s);case 3:case"end":return e.stop()}})},getSupplyCost:function(r,t){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(feehandleContract.methods.getSupplyCost(r,t).call().then(function(r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n=r;case 1:case"end":return e.stop()}})}));case 2:return e.abrupt("return",parseFloat(web3.utils.fromWei(n,"ether")).toFixed(2));case 3:case"end":return e.stop()}})},updateCrew:function(r,t,e,n){var a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.updateCrew(t,n,n).send({from:r}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:a=!0;case 1:case"end":return e.stop()}})}).catch(function(){a=!1}));case 2:return e.abrupt("return",a);case 3:case"end":return e.stop()}})},claimReward:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.claimReward().send({from:r}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0;case 1:case"end":return e.stop()}})}).catch(function(){t=!1}));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}})},getUnclaimedMDC:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(rewardpoolContract.methods.getUnclaimedMDC().send({from:r}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0;case 1:case"end":return e.stop()}})}).catch(function(){t=!1}));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}})},getMinClaimTax:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(feehandleContract.methods.getMinClaimTax().call({from:r}).then(function(r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:t=r;case 1:case"end":return e.stop()}})}).catch(function(){}));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}})},dismiss:function(r,t,n){var a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.Dismiss(t,n).send({from:r}).then(function(r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(r),a=parseFloat(web3.utils.fromWei(r.events.Dismissed.returnValues.amount,"ether")).toFixed(2);case 2:case"end":return e.stop()}})}).catch(function(e){console.log(e),a=!1}));case 2:return e.abrupt("return",a);case 3:case"end":return e.stop()}})},getTrainingCost:function(e,r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(feehandleContract.methods.getTrainingCost(r).call().then(function(r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:t=r;case 1:case"end":return e.stop()}})}));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}})},getCostForAddingDancer:function(r,t){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(feehandleContract.methods.getCostForAddingDancer(r,t).call().then(function(r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n=r;case 1:case"end":return e.stop()}})}));case 2:return e.abrupt("return",n);case 3:case"end":return e.stop()}})},dateBonusClaim:function(r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(rewardpoolContract.methods.dateBonusClaim(r).call().then(function(r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:t=r;case 1:case"end":return e.stop()}})}));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}})}}},_default=Display;exports.default=Display;