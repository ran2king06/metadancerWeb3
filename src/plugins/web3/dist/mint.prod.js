"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _web=_interopRequireDefault(require("web3"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var mintResultDancer,mintResultCoach,mintResultCrew,web3=new _web.default(window.ethereum),dancerAbi=require("./abi/dancer_abi.json"),coachAbi=require("./abi/coach_abi.json"),crewAbi=require("./abi/crew_abi.json"),tokenMDC=require("./abi/token_mdc.json"),feeAbi=require("./abi/freehandler_abi.json"),tokenAddress=process.env.VUE_APP_TOKEN_ADDRESS,dancerAddress=process.env.VUE_APP_DANCER_ADDRESS,coachAddress=process.env.VUE_APP_COACH_ADDRESS,crewAddress=process.env.VUE_APP_CREW_ADDRESS,feeHandlerAddress=process.env.VUE_APP_FEE_HANDLER,noReferralAddress=process.env.VUE_APP_REFERRAL_ADDRESS,dancerTokenContract=new web3.eth.Contract(dancerAbi,tokenAddress),dancerContract=new web3.eth.Contract(dancerAbi,dancerAddress),coachTokenContract=new web3.eth.Contract(coachAbi,tokenAddress),coachContract=new web3.eth.Contract(coachAbi,coachAddress),crewTokenContract=new web3.eth.Contract(crewAbi,tokenAddress),crewContract=new web3.eth.Contract(crewAbi,crewAddress),tokenContract=new web3.eth.Contract(tokenMDC,tokenAddress),feehandlerContract=new web3.eth.Contract(feeAbi,feeHandlerAddress),Mint=function(){return{mintDancer:function(n,r,t){var c;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return c=null!=t&&""!==t?t:noReferralAddress,e.next=3,regeneratorRuntime.awrap(tokenContract.methods.allowance(n,dancerAddress).call().then(function(t){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(parseInt(t)<web3.utils.toWei("1000","ether"))return e.next=3,regeneratorRuntime.awrap(dancerTokenContract.methods.approve(dancerAddress,web3.utils.toWei("10000","ether")).send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(dancerContract.methods.requestRandomWords().send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(dancerContract.methods.mint(r,c).send({from:n}).then(function(e){console.log(e),mintResultDancer=!0}).catch(function(){mintResultDancer=!1}));case 2:case"end":return e.stop()}})}).catch(function(){mintResultDancer=!1}));case 2:case"end":return e.stop()}})}).catch(function(){mintResultDancer=!1}));e.next=5;break;case 3:e.next=8;break;case 5:if(parseInt(t)>=web3.utils.toWei("1000","ether"))return e.next=8,regeneratorRuntime.awrap(dancerContract.methods.requestRandomWords().send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(dancerContract.methods.mint(r,c).send({from:n}).then(function(){mintResultDancer=!0}).catch(function(){mintResultDancer=!1}));case 2:case"end":return e.stop()}})}).catch(function(){mintResultDancer=!1}));e.next=8;break;case 8:case"end":return e.stop()}})}).catch(function(e){console.log(e)}));case 3:return e.abrupt("return",mintResultDancer);case 4:case"end":return e.stop()}})},mintCoach:function(n,r,t){var c;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return c=null!=t&&""!==t?t:noReferralAddress,e.next=3,regeneratorRuntime.awrap(tokenContract.methods.allowance(n,coachAddress).call().then(function(t){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(parseInt(t)<web3.utils.toWei("1000","ether"))return e.next=3,regeneratorRuntime.awrap(coachTokenContract.methods.approve(coachAddress,web3.utils.toWei("10000","ether")).send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(coachContract.methods.requestRandomWords().send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(coachContract.methods.mint(r,c).send({from:n}).then(function(){mintResultCoach=!0}).catch(function(){mintResultCoach=!1}));case 2:case"end":return e.stop()}})}).catch(function(){mintResultCoach=!1}));case 2:case"end":return e.stop()}})}).catch(function(){mintResultCoach=!1}));e.next=5;break;case 3:e.next=8;break;case 5:if(parseInt(t)>=web3.utils.toWei("1000","ether"))return e.next=8,regeneratorRuntime.awrap(coachContract.methods.requestRandomWords().send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(coachContract.methods.mint(r,c).send({from:n}).then(function(){mintResultCoach=!0}).catch(function(){mintResultCoach=!1}));case 2:case"end":return e.stop()}})}).catch(function(){mintResultCoach=!1}));e.next=8;break;case 8:case"end":return e.stop()}})}).catch(function(e){console.log(e)}));case 3:return e.abrupt("return",mintResultCoach);case 4:case"end":return e.stop()}})},mintCrew:function(n,r,c,a){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(tokenContract.methods.allowance(n,crewAddress).call().then(function(t){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(parseInt(t)<web3.utils.toWei("1000","ether"))return e.next=3,regeneratorRuntime.awrap(crewTokenContract.methods.approve(crewAddress,web3.utils.toWei("10000","ether")).send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(coachContract.methods.setApprovalForAll(crewAddress,!0).send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(dancerContract.methods.setApprovalForAll(crewAddress,!0).send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.mint(r,c,a).send({from:n}).then(function(){mintResultCrew=!0}).catch(function(){mintResultCrew=!1}));case 2:case"end":return e.stop()}})}).catch(function(){mintResultCrew=!1}));case 2:case"end":return e.stop()}})}).catch(function(){mintResultCrew=!1}));case 2:case"end":return e.stop()}})}).catch(function(){mintResultCrew=!1}));e.next=5;break;case 3:e.next=8;break;case 5:if(parseInt(t)>=web3.utils.toWei("1000","ether"))return e.next=8,regeneratorRuntime.awrap(coachContract.methods.isApprovedForAll(n,crewAddress).call().then(function(t){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(!1===t)return e.next=3,regeneratorRuntime.awrap(coachContract.methods.setApprovalForAll(crewAddress,!0).send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(dancerContract.methods.isApprovedForAll(n,crewAddress).send({from:n}).then(function(t){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(!1===t)return e.next=3,regeneratorRuntime.awrap(dancerContract.methods.setApprovalForAll(crewAddress,!0).send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.mint(r,c,a).send({from:n}).then(function(){mintResultCrew=!0}).catch(function(){mintResultCrew=!1}));case 2:case"end":return e.stop()}})}).catch(function(){mintResultCrew=!1}));e.next=5;break;case 3:e.next=7;break;case 5:return e.next=7,regeneratorRuntime.awrap(crewContract.methods.mint(r,c,a).send({from:n}).then(function(){mintResultCrew=!0}).catch(function(){mintResultCrew=!1}));case 7:case"end":return e.stop()}})}).catch(function(){mintResultCrew=!1}));case 2:case"end":return e.stop()}})}));e.next=5;break;case 3:e.next=7;break;case 5:return e.next=7,regeneratorRuntime.awrap(dancerContract.methods.isApprovedForAll(n,crewAddress).call().then(function(t){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(!1===t.status)return e.next=3,regeneratorRuntime.awrap(dancerContract.methods.setApprovalForAll(crewAddress,!0).send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.mint(r,c,a).send({from:n}).then(function(){mintResultCrew=!0}).catch(function(){mintResultCrew=!1}));case 2:case"end":return e.stop()}})}).catch(function(){mintResultCrew=!1}));e.next=5;break;case 3:e.next=7;break;case 5:return e.next=7,regeneratorRuntime.awrap(crewContract.methods.mint(r,c,a).send({from:n}).then(function(){mintResultCrew=!0}).catch(function(){mintResultCrew=!1}));case 7:case"end":return e.stop()}})}).catch(function(){mintResultCrew=!1}));case 7:case"end":return e.stop()}})}).catch(function(){mintResultCrew=!1}).catch(function(){mintResultCrew=!1}));e.next=8;break;case 8:case"end":return e.stop()}})}).catch(function(e){console.log(e)}));case 2:return e.abrupt("return",mintResultCrew);case 3:case"end":return e.stop()}})},updateCrew:function(n,r,c,a){var o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(tokenContract.methods.allowance(n,crewAddress).call().then(function(t){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(parseInt(t)<web3.utils.toWei("1000","ether"))return e.next=3,regeneratorRuntime.awrap(crewTokenContract.methods.approve(crewAddress,web3.utils.toWei("10000","ether")).send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(crewContract.methods.updateCrew(r,c,a).send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:o=!0;case 1:case"end":return e.stop()}})}).catch(function(){o=!1}));case 2:case"end":return e.stop()}})}));e.next=5;break;case 3:e.next=8;break;case 5:if(parseInt(t)>=web3.utils.toWei("1000","ether"))return e.next=8,regeneratorRuntime.awrap(crewContract.methods.updateCrew(r,c,a).send({from:n}).then(function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:o=!0;case 1:case"end":return e.stop()}})}).catch(function(){o=!1}));e.next=8;break;case 8:case"end":return e.stop()}})}));case 2:return e.abrupt("return",o);case 3:case"end":return e.stop()}})},getMintPrice:function(t){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(feehandlerContract.methods.getMintingPrice(t).call().then(function(t){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:n=t;case 1:case"end":return e.stop()}})}));case 2:return e.abrupt("return",parseFloat(web3.utils.fromWei(n,"ether")).toFixed(2));case 3:case"end":return e.stop()}})}}},_default=Mint;exports.default=Mint;